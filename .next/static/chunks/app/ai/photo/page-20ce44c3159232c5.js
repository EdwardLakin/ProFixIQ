(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{53:(e,l,a)=>{"use strict";a.d(l,{g:()=>r});var t=a(2115);let s="selectedVehicle",r=()=>{let[e,l]=(0,t.useState)(null);return(0,t.useEffect)(()=>{let e=localStorage.getItem(s);if(e)try{l(JSON.parse(e))}catch(e){console.error("Failed to parse stored vehicle info:",e)}},[]),(0,t.useEffect)(()=>{e&&localStorage.setItem(s,JSON.stringify(e))},[e]),{vehicleInfo:e,updateVehicle:e=>{l(e),localStorage.setItem(s,JSON.stringify(e))},clearVehicle:()=>{l(null),localStorage.removeItem(s)}}}},4015:(e,l,a)=>{"use strict";a.d(l,{A:()=>r});var t=a(5155);a(2115);var s=a(53);function r(){let{vehicle:e,setVehicle:l}=(0,s.g)(),a=a=>{let{name:t,value:s}=a.target;l({...e,[t]:s})};return(0,t.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Vehicle Info"}),(0,t.jsx)("input",{type:"text",name:"year",placeholder:"Year",value:(null==e?void 0:e.year)||"",onChange:a,className:"w-full p-2 border rounded"}),(0,t.jsx)("input",{type:"text",name:"make",placeholder:"Make",value:(null==e?void 0:e.make)||"",onChange:a,className:"w-full p-2 border rounded"}),(0,t.jsx)("input",{type:"text",name:"model",placeholder:"Model",value:(null==e?void 0:e.model)||"",onChange:a,className:"w-full p-2 border rounded"})]})}},4193:(e,l,a)=>{Promise.resolve().then(a.bind(a,8572))},8572:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>i});var t=a(5155),s=a(2115),r=a(53);function n(e){let{onImageSelect:l}=e,a=(0,s.useRef)(null),[r,n]=(0,s.useState)(null);return(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var e;null==(e=a.current)||e.click()},className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Capture or Upload Photo"}),(0,t.jsx)("input",{type:"file",accept:"image/*",capture:"environment",ref:a,onChange:e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];t&&(n(URL.createObjectURL(t)),l(t))},className:"hidden"}),r&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("img",{src:r,alt:"Preview",className:"max-w-full h-auto rounded border"})})]})}var o=a(4015);function i(){let{localVehicle:e}=(0,r.g)(),[l,a]=(0,s.useState)(null),[i,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),p=e=>new Promise((l,a)=>{let t=new FileReader;t.onloadend=()=>{var e;let s=null==(e=t.result)?void 0:e.toString().split(",")[1];s?l(s):a("Failed to convert image to base64")},t.onerror=a,t.readAsDataURL(e)}),g=async()=>{if(!l||!e)return void h("Please select a vehicle and upload an image.");c(!0),h(null),u(null);try{let a=await p(l),t=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:a,vehicle:e})}),s=await t.json();t.ok&&s.result?u(s.result):h(s.error||"Unknown error occurred")}catch(e){console.error(e),h("Failed to analyze image.")}finally{c(!1)}};return(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Visual Diagnosis"}),(0,t.jsx)(o.A,{}),(0,t.jsx)(n,{onImageSelect:a}),(0,t.jsx)("button",{onClick:g,disabled:i,className:"bg-blue-600 text-white px-4 py-2 rounded shadow",children:i?"Analyzing...":"Analyze"}),m&&(0,t.jsx)("p",{className:"text-red-600",children:m}),d&&(0,t.jsxs)("div",{className:"p-4 bg-gray-100 rounded",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"Diagnosis Result:"}),(0,t.jsx)("pre",{children:d})]})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[441,684,358],()=>l(4193)),_N_E=e.O()}]);